"use strict";(globalThis.webpackChunkphysical_ai_platform_frontend=globalThis.webpackChunkphysical_ai_platform_frontend||[]).push([[2600],{6291:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"module-1/week-4-tf-urdf","title":"Week 4: TF and URDF","description":"Overview","source":"@site/docs/module-1/week-4-tf-urdf.md","sourceDirName":"module-1","slug":"/module-1/week-4-tf-urdf","permalink":"/docs/module-1/week-4-tf-urdf","draft":false,"unlisted":false,"editUrl":"https://github.com/noor-ana/physical-ai-platform/tree/main/docs/module-1/week-4-tf-urdf.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"difficulty":"beginner"}}');var t=n(4848),s=n(8453);const o={sidebar_position:4,difficulty:"beginner"},a="Week 4: TF and URDF",l={},m=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"TF (Transforms) in ROS 2",id:"tf-transforms-in-ros-2",level:2},{value:"Coordinate Frames",id:"coordinate-frames",level:3},{value:"TF2 Concepts",id:"tf2-concepts",level:3},{value:"Basic TF2 Usage",id:"basic-tf2-usage",level:3},{value:"Publishing Transforms",id:"publishing-transforms",level:3},{value:"URDF (Unified Robot Description Format)",id:"urdf-unified-robot-description-format",level:2},{value:"URDF Components",id:"urdf-components",level:3},{value:"Basic URDF Example",id:"basic-urdf-example",level:3},{value:"Robot State Publisher",id:"robot-state-publisher",level:2},{value:"Using Robot State Publisher",id:"using-robot-state-publisher",level:3},{value:"TF and URDF Commands",id:"tf-and-urdf-commands",level:2},{value:"Practical Example: Mobile Robot URDF",id:"practical-example-mobile-robot-urdf",level:2},{value:"Common TF Issues and Solutions",id:"common-tf-issues-and-solutions",level:2},{value:"Integration with Perception and Navigation",id:"integration-with-perception-and-navigation",level:2},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"week-4-tf-and-urdf",children:"Week 4: TF and URDF"})}),"\n",(0,t.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(r.p,{children:"This week covers two critical concepts in robotics: TF (Transforms) for representing spatial relationships, and URDF (Unified Robot Description Format) for describing robot structure and kinematics. These tools are essential for robot perception, navigation, and manipulation."}),"\n",(0,t.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsx)(r.p,{children:"By the end of this week, you will:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Understand the concept of coordinate frames and transforms"}),"\n",(0,t.jsx)(r.li,{children:"Work with the TF2 system in ROS 2"}),"\n",(0,t.jsx)(r.li,{children:"Create and interpret URDF files"}),"\n",(0,t.jsx)(r.li,{children:"Use robot state publishers"}),"\n",(0,t.jsx)(r.li,{children:"Implement frame transformations"}),"\n",(0,t.jsx)(r.li,{children:"Debug TF trees"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"tf-transforms-in-ros-2",children:"TF (Transforms) in ROS 2"}),"\n",(0,t.jsx)(r.p,{children:"TF (Transforms) is a package that lets the user keep track of multiple coordinate frames over time. It maintains the relationship between coordinate frames in a tree structure buffered in time, and lets the user transform points, vectors, etc., between any two coordinate frames at any desired point in time."}),"\n",(0,t.jsx)(r.h3,{id:"coordinate-frames",children:"Coordinate Frames"}),"\n",(0,t.jsx)(r.p,{children:"A coordinate frame is a reference system that defines position and orientation in space. Common frames in robotics include:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"map"}),": World-fixed frame"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"odom"}),": Odometry-based frame"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"base_link"}),": Robot's base frame"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"camera_frame"}),": Camera's reference frame"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"tool0"}),": Tool end-effector frame"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"tf2-concepts",children:"TF2 Concepts"}),"\n",(0,t.jsx)(r.p,{children:"TF2 is the second generation of the transform library in ROS. It provides:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Transform Storage"}),": Maintains a tree of coordinate frame transformations"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Lookup"}),": Retrieves transformations between any two frames"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Interpolation"}),": Provides transformations at specific times"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Extrapolation Protection"}),": Prevents use of outdated transforms"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"basic-tf2-usage",children:"Basic TF2 Usage"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom tf2_ros import TransformException\r\nfrom tf2_ros.buffer import Buffer\r\nfrom tf2_ros.transform_listener import TransformListener\r\nfrom geometry_msgs.msg import TransformStamped\r\n\r\nclass FrameListener(Node):\r\n    def __init__(self):\r\n        super().__init__('frame_listener')\r\n        \r\n        # Create a buffer to store transforms\r\n        self.tf_buffer = Buffer()\r\n        \r\n        # Create a transform listener\r\n        self.tf_listener = TransformListener(self.tf_buffer, self)\r\n        \r\n        # Timer to periodically lookup transforms\r\n        self.timer = self.create_timer(1.0, self.lookup_transform)\r\n\r\n    def lookup_transform(self):\r\n        try:\r\n            # Look up transform from 'base_link' to 'camera_link' at current time\r\n            t = self.tf_buffer.lookup_transform(\r\n                'base_link',\r\n                'camera_link',\r\n                rclpy.time.Time())\r\n                \r\n            self.get_logger().info(\r\n                f'Transform: ({t.transform.translation.x}, '\r\n                f'{t.transform.translation.y}, '\r\n                f'{t.transform.translation.z})')\r\n                \r\n        except TransformException as ex:\r\n            self.get_logger().info(f'Could not transform: {ex}')\r\n            return\n"})}),"\n",(0,t.jsx)(r.h3,{id:"publishing-transforms",children:"Publishing Transforms"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import TransformStamped\r\nfrom tf2_ros import TransformBroadcaster\r\n\r\nclass FramePublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('frame_publisher')\r\n\r\n        # Create a transform broadcaster\r\n        self.tf_broadcaster = TransformBroadcaster(self)\r\n\r\n        # Timer to broadcast transforms\r\n        self.timer = self.create_timer(0.1, self.broadcast_transform)\r\n\r\n    def broadcast_transform(self):\r\n        t = TransformStamped()\r\n\r\n        t.header.stamp = self.get_clock().now().to_msg()\r\n        t.header.frame_id = 'base_link'\r\n        t.child_frame_id = 'camera_link'\r\n\r\n        # Define the transform\r\n        t.transform.translation.x = 0.1\r\n        t.transform.translation.y = 0.0\r\n        t.transform.translation.z = 0.2\r\n        t.transform.rotation.x = 0.0\r\n        t.transform.rotation.y = 0.0\r\n        t.transform.rotation.z = 0.0\r\n        t.transform.rotation.w = 1.0\r\n\r\n        # Broadcast the transform\r\n        self.tf_broadcaster.sendTransform(t)\n"})}),"\n",(0,t.jsx)(r.h2,{id:"urdf-unified-robot-description-format",children:"URDF (Unified Robot Description Format)"}),"\n",(0,t.jsx)(r.p,{children:"URDF is an XML format for representing a robot model. It defines the kinematic and dynamic structure of a robot, including links, joints, materials, and visual/inertial properties."}),"\n",(0,t.jsx)(r.h3,{id:"urdf-components",children:"URDF Components"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Links"}),": Rigid parts of the robot (e.g., chassis, wheels, end-effector)"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Joints"}),": Connections between links (e.g., revolute, prismatic)"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Visual"}),": How the robot appears in simulation/visualization"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Inertial"}),": Mass, center of mass, and inertia properties"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Collision"}),": Collision detection geometry"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"basic-urdf-example",children:"Basic URDF Example"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<robot name="simple_robot">\r\n  \x3c!-- Base link --\x3e\r\n  <link name="base_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.5 0.5 0.2"/>\r\n      </geometry>\r\n      <material name="blue">\r\n        <color rgba="0 0 1 1"/>\r\n      </material>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <box size="0.5 0.5 0.2"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="1.0"/>\r\n      <inertia ixx="0.1" ixy="0.0" ixz="0.0"\r\n               iyy="0.1" iyz="0.0"\r\n               izz="0.1"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  \x3c!-- Wheel links --\x3e\r\n  <link name="wheel_left">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder length="0.05" radius="0.1"/>\r\n      </geometry>\r\n      <material name="black">\r\n        <color rgba="0 0 0 1"/>\r\n      </material>\r\n    </visual>\r\n  </link>\r\n\r\n  <link name="wheel_right">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder length="0.05" radius="0.1"/>\r\n      </geometry>\r\n      <material name="black"/>\r\n    </visual>\r\n  </link>\r\n\r\n  \x3c!-- Joints connecting wheels to base --\x3e\r\n  <joint name="left_wheel_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="wheel_left"/>\r\n    <origin xyz="-0.15 0.25 -0.1" rpy="0 0 0"/>\r\n    <axis xyz="0 1 0"/>\r\n  </joint>\r\n\r\n  <joint name="right_wheel_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="wheel_right"/>\r\n    <origin xyz="-0.15 -0.25 -0.1" rpy="0 0 0"/>\r\n    <axis xyz="0 1 0"/>\r\n  </joint>\r\n</robot>\n'})}),"\n",(0,t.jsx)(r.h2,{id:"robot-state-publisher",children:"Robot State Publisher"}),"\n",(0,t.jsx)(r.p,{children:"The robot_state_publisher package takes the joint angles of a robot and calculates the 3D poses of the robot links. It publishes the transforms between the links using the tf2 package."}),"\n",(0,t.jsx)(r.h3,{id:"using-robot-state-publisher",children:"Using Robot State Publisher"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import JointState\r\nfrom std_msgs.msg import Header\r\nfrom tf2_ros import TransformBroadcaster\r\nfrom geometry_msgs.msg import TransformStamped\r\nimport math\r\n\r\nclass StatePublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('state_publisher')\r\n        \r\n        # Initialize joint state publisher\r\n        self.joint_pub = self.create_publisher(JointState, 'joint_states', 10)\r\n        \r\n        # Timer to publish joint states\r\n        self.timer = self.create_timer(0.1, self.publish_joint_states)\r\n\r\n    def publish_joint_states(self):\r\n        # Create joint state message\r\n        msg = JointState()\r\n        msg.name = ['left_wheel_joint', 'right_wheel_joint']\r\n        msg.position = [math.sin(self.get_clock().now().nanoseconds / 1e9),\r\n                        math.cos(self.get_clock().now().nanoseconds / 1e9)]\r\n        msg.header.stamp = self.get_clock().now().to_msg()\r\n        msg.header.frame_id = 'base_link'\r\n        \r\n        # Publish joint states\r\n        self.joint_pub.publish(msg)\n"})}),"\n",(0,t.jsx)(r.h2,{id:"tf-and-urdf-commands",children:"TF and URDF Commands"}),"\n",(0,t.jsx)(r.p,{children:"Useful command-line tools for working with TF and URDF:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# TF tools\r\nros2 run tf2_tools view_frames                    # View TF tree\r\nros2 run tf2_ros tf2_echo frame_id                # Echo transform\r\nros2 run rviz2 rviz2                              # Visualize TF tree in RViz\r\n\r\n# URDF tools\r\ncheck_urdf /path/to/robot.urdf                    # Validate URDF\r\nros2 run xacro xacro /path/to/robot.xacro > robot.urdf  # Process Xacro\n"})}),"\n",(0,t.jsx)(r.h2,{id:"practical-example-mobile-robot-urdf",children:"Practical Example: Mobile Robot URDF"}),"\n",(0,t.jsx)(r.p,{children:"Here's a more complete mobile robot URDF example with TF setup:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<robot name="mobile_robot" xmlns:xacro="http://ros.org/wiki/xacro">\r\n  <material name="orange">\r\n    <color rgba="1.0 0.5 0.0 1.0"/>\r\n  </material>\r\n\r\n  <material name="black">\r\n    <color rgba="0.0 0.0 0.0 1.0"/>\r\n  </material>\r\n\r\n  \x3c!-- Base link --\x3e\r\n  <link name="base_link">\r\n    <visual>\r\n      <origin xyz="0 0 0.1" rpy="0 0 0"/>\r\n      <geometry>\r\n        <box size="0.5 0.3 0.2"/>\r\n      </geometry>\r\n      <material name="orange"/>\r\n    </visual>\r\n    <collision>\r\n      <origin xyz="0 0 0.1" rpy="0 0 0"/>\r\n      <geometry>\r\n        <box size="0.5 0.3 0.2"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="1.0"/>\r\n      <inertia ixx="0.05" ixy="0.0" ixz="0.0"\r\n               iyy="0.083" iyz="0.0"\r\n               izz="0.133"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  \x3c!-- Camera link --\x3e\r\n  <link name="camera_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.05 0.05 0.05"/>\r\n      </geometry>\r\n      <material name="black"/>\r\n    </visual>\r\n  </link>\r\n\r\n  \x3c!-- Camera joint --\x3e\r\n  <joint name="camera_joint" type="fixed">\r\n    <parent link="base_link"/>\r\n    <child link="camera_link"/>\r\n    <origin xyz="0.2 0 0.15" rpy="0 0 0"/>\r\n  </joint>\r\n\r\n  \x3c!-- Left wheel --\x3e\r\n  <link name="wheel_left">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder radius="0.1" length="0.05"/>\r\n      </geometry>\r\n      <material name="black"/>\r\n    </visual>\r\n  </link>\r\n\r\n  <joint name="wheel_left_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="wheel_left"/>\r\n    <origin xyz="0 0.18 -0.1" rpy="-1.5708 0 0"/>\r\n  </joint>\r\n\r\n  \x3c!-- Right wheel --\x3e\r\n  <link name="wheel_right">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder radius="0.1" length="0.05"/>\r\n      </geometry>\r\n      <material name="black"/>\r\n    </visual>\r\n  </link>\r\n\r\n  <joint name="wheel_right_joint" type="continuous">\r\n    <parent link="base_link"/>\r\n    <child link="wheel_right"/>\r\n    <origin xyz="0 -0.18 -0.1" rpy="-1.5708 0 0"/>\r\n  </joint>\r\n</robot>\n'})}),"\n",(0,t.jsx)(r.h2,{id:"common-tf-issues-and-solutions",children:"Common TF Issues and Solutions"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Timestamp issues"}),": Ensure transforms are published with correct timestamps"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Buffer timeout"}),": Increase buffer size or frequency of transform publishing"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Circular dependencies"}),": Avoid loops in the TF tree"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Extrapolation errors"}),": Wait for transforms to be buffered before looking them up"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"integration-with-perception-and-navigation",children:"Integration with Perception and Navigation"}),"\n",(0,t.jsx)(r.p,{children:"TF is critical for:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Sensor fusion: Transform sensor data to a common frame"}),"\n",(0,t.jsx)(r.li,{children:"Localization: Transform between map and odom frames"}),"\n",(0,t.jsx)(r.li,{children:"Navigation: Plan trajectories in the map frame"}),"\n",(0,t.jsx)(r.li,{children:"Manipulation: Transform between base and end-effector frames"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(r.p,{children:"This week covered TF (Transforms) and URDF, essential tools for representing spatial relationships and robot structure in ROS 2. You learned how to work with coordinate frames, implement TF2 listeners and broadcasters, create URDF models, and publish joint states. These concepts are fundamental for robot perception, navigation, and manipulation."}),"\n",(0,t.jsx)(r.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"Create a URDF for a simple robot with at least 3 links and 2 joints"}),"\n",(0,t.jsx)(r.li,{children:"Implement a TF broadcaster that publishes transforms for a moving robot"}),"\n",(0,t.jsx)(r.li,{children:"Use robot_state_publisher to visualize joint states in RViz"}),"\n",(0,t.jsx)(r.li,{children:"Debug a TF tree with a common issue (timestamp errors, buffer timeouts)"}),"\n"]})]})}function d(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>a});var i=n(6540);const t={},s=i.createContext(t);function o(e){const r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);