"use strict";(globalThis.webpackChunkphysical_ai_platform_frontend=globalThis.webpackChunkphysical_ai_platform_frontend||[]).push([[4649],{6083:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"module-1/week-2-nodes-topics/2-4-practical-topics-exercises","title":"2.4: Practical Exercises - Advanced Topics and Node Integration","description":"Overview","source":"@site/docs/module-1/week-2-nodes-topics/2-4-practical-topics-exercises.md","sourceDirName":"module-1/week-2-nodes-topics","slug":"/module-1/week-2-nodes-topics/2-4-practical-topics-exercises","permalink":"/docs/module-1/week-2-nodes-topics/2-4-practical-topics-exercises","draft":false,"unlisted":false,"editUrl":"https://github.com/noor-ana/physical-ai-platform/tree/main/docs/module-1/week-2-nodes-topics/2-4-practical-topics-exercises.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"difficulty":"beginner"},"sidebar":"tutorialSidebar","previous":{"title":"2.3: Topic Design Patterns and Best Practices","permalink":"/docs/module-1/week-2-nodes-topics/2-3-topic-design-patterns"},"next":{"title":"3.1: Understanding ROS 2 Services","permalink":"/docs/module-1/week-3-services-actions/3-1-understanding-services"}}');var t=n(4848),o=n(8453);const i={sidebar_position:4,difficulty:"beginner"},l="2.4: Practical Exercises - Advanced Topics and Node Integration",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Exercise 1: Multi-Node Robot System",id:"exercise-1-multi-node-robot-system",level:2},{value:"Objective",id:"objective",level:3},{value:"Steps",id:"steps",level:3},{value:"Exercise 2: Implementing Custom Messages and QoS",id:"exercise-2-implementing-custom-messages-and-qos",level:2},{value:"Objective",id:"objective-1",level:3},{value:"Steps",id:"steps-1",level:3},{value:"Exercise 3: Performance Analysis and Optimization",id:"exercise-3-performance-analysis-and-optimization",level:2},{value:"Objective",id:"objective-2",level:3},{value:"Steps",id:"steps-2",level:3},{value:"Exercise 4: Error Handling and Recovery",id:"exercise-4-error-handling-and-recovery",level:2},{value:"Objective",id:"objective-3",level:3},{value:"Steps",id:"steps-3",level:3},{value:"Exercise 5: System Integration Testing",id:"exercise-5-system-integration-testing",level:2},{value:"Objective",id:"objective-4",level:3},{value:"Steps",id:"steps-4",level:3},{value:"Summary",id:"summary",level:2},{value:"Additional Challenges",id:"additional-challenges",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"24-practical-exercises---advanced-topics-and-node-integration",children:"2.4: Practical Exercises - Advanced Topics and Node Integration"})}),"\n",(0,t.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(r.p,{children:"This submodule provides hands-on exercises to integrate the concepts learned about nodes and topics. You'll build a more complex robot simulation system with multiple interconnected nodes communicating through topics."}),"\n",(0,t.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsx)(r.p,{children:"By the end of this submodule, you will:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Design and implement a multi-node robot system"}),"\n",(0,t.jsx)(r.li,{children:"Create custom message types for specific applications"}),"\n",(0,t.jsx)(r.li,{children:"Configure QoS settings appropriately for different data types"}),"\n",(0,t.jsx)(r.li,{children:"Implement robust error handling for topic communication"}),"\n",(0,t.jsx)(r.li,{children:"Use ROS 2 tools to debug and monitor your system"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"exercise-1-multi-node-robot-system",children:"Exercise 1: Multi-Node Robot System"}),"\n",(0,t.jsx)(r.h3,{id:"objective",children:"Objective"}),"\n",(0,t.jsx)(r.p,{children:"Create a robot system with sensor, controller, and monitor nodes that communicate via topics."}),"\n",(0,t.jsx)(r.h3,{id:"steps",children:"Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create a new package"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"cd ~/ros2_ws/src\r\nros2 pkg create --build-type ament_python robot_system\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"2",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create a custom message"})," for robot state (",(0,t.jsx)(r.code,{children:"msg/RobotState.msg"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# RobotState.msg\r\nstd_msgs/Header header\r\nfloat32 x\r\nfloat32 y\r\nfloat32 theta\r\nfloat32 linear_velocity\r\nfloat32 angular_velocity\r\nbool is_moving\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"3",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create the sensor node"})," (",(0,t.jsx)(r.code,{children:"robot_system/robot_system/sensor_node.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import Float32\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import LaserScan\r\nimport random\r\n\r\nclass SensorNode(Node):\r\n    def __init__(self):\r\n        super().__init__('sensor_node')\r\n        \r\n        # Create publishers for different sensor data\r\n        self.laser_pub = self.create_publisher(\r\n            LaserScan, 'laser_scan', 10)\r\n        self.odom_pub = self.create_publisher(\r\n            Float32, 'odometry', 10)\r\n        \r\n        # Create timer for simulated sensor readings\r\n        self.timer = self.create_timer(0.1, self.publish_sensors)  # 10 Hz\r\n        self.get_logger().info('Sensor node started')\r\n\r\n    def publish_sensors(self):\r\n        # Publish simulated laser scan\r\n        laser_msg = LaserScan()\r\n        laser_msg.header.stamp = self.get_clock().now().to_msg()\r\n        laser_msg.header.frame_id = 'laser_frame'\r\n        laser_msg.angle_min = -1.57  # -90 degrees\r\n        laser_msg.angle_max = 1.57   # 90 degrees\r\n        laser_msg.angle_increment = 0.1\r\n        laser_msg.range_min = 0.1\r\n        laser_msg.range_max = 10.0\r\n        laser_msg.ranges = [random.uniform(1.0, 5.0) for _ in range(32)]  # 32 range values\r\n        \r\n        self.laser_pub.publish(laser_msg)\r\n        \r\n        # Publish simulated odometry\r\n        odom_msg = Float32()\r\n        odom_msg.data = random.uniform(0.0, 10.0)\r\n        self.odom_pub.publish(odom_msg)\r\n        \r\n        self.get_logger().debug('Published sensor data')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    sensor_node = SensorNode()\r\n    rclpy.spin(sensor_node)\r\n    sensor_node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"4",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create the controller node"})," (",(0,t.jsx)(r.code,{children:"robot_system/robot_system/controller_node.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import LaserScan\r\nimport math\r\n\r\nclass ControllerNode(Node):\r\n    def __init__(self):\r\n        super().__init__('controller_node')\r\n        \r\n        # Create publisher for velocity commands\r\n        self.cmd_pub = self.create_publisher(Twist, 'cmd_vel', 10)\r\n        \r\n        # Create subscriber for laser data\r\n        self.laser_sub = self.create_subscription(\r\n            LaserScan, 'laser_scan', self.laser_callback, 10)\r\n        \r\n        # Control variables\r\n        self.safe_distance = 1.0  # meters\r\n        self.linear_speed = 0.5   # m/s\r\n        self.angular_speed = 0.3  # rad/s\r\n        \r\n        self.get_logger().info('Controller node started')\r\n\r\n    def laser_callback(self, msg):\r\n        # Find the closest obstacle\r\n        min_distance = min(msg.ranges)\r\n        \r\n        # Create twist message\r\n        twist = Twist()\r\n        \r\n        if min_distance < self.safe_distance:\r\n            # Obstacle detected, turn away\r\n            twist.linear.x = 0.0\r\n            twist.angular.z = self.angular_speed\r\n            self.get_logger().info(f'Obstacle detected! Distance: {min_distance:.2f}m, turning')\r\n        else:\r\n            # Path clear, move forward\r\n            twist.linear.x = self.linear_speed\r\n            twist.angular.z = 0.0\r\n            self.get_logger().info(f'Moving forward, min distance: {min_distance:.2f}m')\r\n        \r\n        # Publish command\r\n        self.cmd_pub.publish(twist)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    controller_node = ControllerNode()\r\n    rclpy.spin(controller_node)\r\n    controller_node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"5",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create the monitor node"})," (",(0,t.jsx)(r.code,{children:"robot_system/robot_system/monitor_node.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import Twist\r\nfrom std_msgs.msg import Float32\r\nimport time\r\n\r\nclass MonitorNode(Node):\r\n    def __init__(self):\r\n        super().__init__('monitor_node')\r\n        \r\n        # Subscribe to command velocities and odometry\r\n        self.cmd_sub = self.create_subscription(\r\n            Twist, 'cmd_vel', self.cmd_callback, 10)\r\n        self.odom_sub = self.create_subscription(\r\n            Float32, 'odometry', self.odom_callback, 10)\r\n        \r\n        # Track performance metrics\r\n        self.cmd_count = 0\r\n        self.odom_count = 0\r\n        self.last_cmd_time = self.get_clock().now()\r\n        self.last_odom_time = self.get_clock().now()\r\n        \r\n        self.get_logger().info('Monitor node started')\r\n\r\n    def cmd_callback(self, msg):\r\n        current_time = self.get_clock().now()\r\n        time_diff = (current_time - self.last_cmd_time).nanoseconds / 1e9\r\n        \r\n        self.cmd_count += 1\r\n        self.last_cmd_time = current_time\r\n        \r\n        # Log command info\r\n        self.get_logger().info(\r\n            f'CMD #{self.cmd_count}: Vx={msg.linear.x:.2f}, Wz={msg.angular.z:.2f}, '\r\n            f'Hz={1.0/time_diff if time_diff>0 else 0:.2f}')\r\n\r\n    def odom_callback(self, msg):\r\n        current_time = self.get_clock().now()\r\n        time_diff = (current_time - self.last_odom_time).nanoseconds / 1e9\r\n        \r\n        self.odom_count += 1\r\n        self.last_odom_time = current_time\r\n        \r\n        # Log odometry info\r\n        self.get_logger().info(\r\n            f'ODOM #{self.odom_count}: Pos={msg.data:.2f}, '\r\n            f'Hz={1.0/time_diff if time_diff>0 else 0:.2f}')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    monitor_node = MonitorNode()\r\n    rclpy.spin(monitor_node)\r\n    monitor_node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,t.jsx)(r.h2,{id:"exercise-2-implementing-custom-messages-and-qos",children:"Exercise 2: Implementing Custom Messages and QoS"}),"\n",(0,t.jsx)(r.h3,{id:"objective-1",children:"Objective"}),"\n",(0,t.jsx)(r.p,{children:"Create and use custom messages with appropriate QoS settings for different data types."}),"\n",(0,t.jsx)(r.h3,{id:"steps-1",children:"Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Update the package.xml"})," to include message generation:"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\r\n<package format="3">\r\n  <name>robot_system</name>\r\n  <version>0.1.0</version>\r\n  <description>Robot system with multiple nodes</description>\r\n  <maintainer email="user@example.com">User</maintainer>\r\n  <license>Apache-2.0</license>\r\n\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n  <depend>geometry_msgs</depend>\r\n  <depend>sensor_msgs</depend>\r\n\r\n  <buildtool_depend>ament_python</buildtool_depend>\r\n  <build_depend>rosidl_default_generators</build_depend>\r\n  <exec_depend>rosidl_default_runtime</exec_depend>\r\n  <member_of_group>rosidl_interface_packages</member_of_group>\r\n\r\n  <test_depend>ament_copyright</test_depend>\r\n  <test_depend>ament_flake8</test_depend>\r\n  <test_depend>ament_pep257</test_depend>\r\n  <test_depend>python3-pytest</test_depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n",(0,t.jsxs)(r.ol,{start:"2",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Update setup.py"})," to include the custom message:"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"from setuptools import setup\r\nfrom glob import glob\r\nimport os\r\n\r\npackage_name = 'robot_system'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.1.0',\r\n    packages=[package_name],\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n        # Include any launch files\r\n        (os.path.join('share', package_name, 'launch'), glob('launch/*.py')),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='User',\r\n    maintainer_email='user@example.com',\r\n    description='Robot system with multiple nodes',\r\n    license='Apache-2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'sensor_node = robot_system.sensor_node:main',\r\n            'controller_node = robot_system.controller_node:main',\r\n            'monitor_node = robot_system.monitor_node:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"3",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create a launch file"})," (",(0,t.jsx)(r.code,{children:"robot_system/launch/robot_system_launch.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"from launch import LaunchDescription\r\nfrom launch_ros.actions import Node\r\n\r\ndef generate_launch_description():\r\n    return LaunchDescription([\r\n        Node(\r\n            package='robot_system',\r\n            executable='sensor_node',\r\n            name='sensor_node',\r\n            output='screen',\r\n            # Set parameters if needed\r\n            # parameters=[{'param_name': 'param_value'}]\r\n        ),\r\n        Node(\r\n            package='robot_system',\r\n            executable='controller_node',\r\n            name='controller_node',\r\n            output='screen',\r\n        ),\r\n        Node(\r\n            package='robot_system',\r\n            executable='monitor_node',\r\n            name='monitor_node',\r\n            output='screen',\r\n        ),\r\n    ])\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"4",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Build and run"})," the system:"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select robot_system\r\nsource install/setup.bash\r\nros2 launch robot_system robot_system_launch.py\n"})}),"\n",(0,t.jsx)(r.h2,{id:"exercise-3-performance-analysis-and-optimization",children:"Exercise 3: Performance Analysis and Optimization"}),"\n",(0,t.jsx)(r.h3,{id:"objective-2",children:"Objective"}),"\n",(0,t.jsx)(r.p,{children:"Analyze the performance of your system and optimize it."}),"\n",(0,t.jsx)(r.h3,{id:"steps-2",children:"Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Add performance monitoring to the controller"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"# Add to controller node\r\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\r\n\r\nclass ControllerNode(Node):\r\n    def __init__(self):\r\n        super().__init__('controller_node')\r\n        \r\n        # Use appropriate QoS for laser data (high-frequency)\r\n        laser_qos = QoSProfile(\r\n            depth=5,\r\n            reliability=ReliabilityPolicy.BEST_EFFORT,\r\n            history=HistoryPolicy.KEEP_LAST\r\n        )\r\n        \r\n        # More reliable QoS for commands\r\n        cmd_qos = QoSProfile(\r\n            depth=10,\r\n            reliability=ReliabilityPolicy.RELIABLE,\r\n            history=HistoryPolicy.KEEP_LAST\r\n        )\r\n        \r\n        # Create publisher and subscriber with appropriate QoS\r\n        self.cmd_pub = self.create_publisher(Twist, 'cmd_vel', cmd_qos)\r\n        self.laser_sub = self.create_subscription(\r\n            LaserScan, 'laser_scan', self.laser_callback, laser_qos)\r\n        \r\n        # Performance tracking\r\n        self.processing_times = []\r\n        self.get_logger().info('Controller node started with QoS optimization')\r\n\r\n    def laser_callback(self, msg):\r\n        start_time = self.get_clock().now()\r\n        \r\n        # Your existing laser processing code here\r\n        min_distance = min(msg.ranges)\r\n        twist = Twist()\r\n        \r\n        if min_distance < self.safe_distance:\r\n            twist.linear.x = 0.0\r\n            twist.angular.z = self.angular_speed\r\n        else:\r\n            twist.linear.x = self.linear_speed\r\n            twist.angular.z = 0.0\r\n        \r\n        self.cmd_pub.publish(twist)\r\n        \r\n        # Track processing time\r\n        end_time = self.get_clock().now()\r\n        processing_time = (end_time - start_time).nanoseconds / 1e6  # milliseconds\r\n        self.processing_times.append(processing_time)\r\n        \r\n        if len(self.processing_times) > 100:\r\n            self.processing_times = self.processing_times[-100:]\r\n        \r\n        avg_time = sum(self.processing_times) / len(self.processing_times)\r\n        self.get_logger().info(f'Processing time: {processing_time:.2f}ms, Avg: {avg_time:.2f}ms')\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"2",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Monitor system performance"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# Monitor topics\r\nros2 topic hz /laser_scan\r\nros2 topic hz /cmd_vel\r\n\r\n# Monitor nodes\r\nros2 run top top\r\n\r\n# Monitor with command-line tools\r\nros2 topic bw\n"})}),"\n",(0,t.jsx)(r.h2,{id:"exercise-4-error-handling-and-recovery",children:"Exercise 4: Error Handling and Recovery"}),"\n",(0,t.jsx)(r.h3,{id:"objective-3",children:"Objective"}),"\n",(0,t.jsx)(r.p,{children:"Implement robust error handling in your system."}),"\n",(0,t.jsx)(r.h3,{id:"steps-3",children:"Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Enhanced sensor node with error handling"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import LaserScan\r\nimport random\r\nfrom rclpy.qos import QoSProfile\r\n\r\nclass RobustSensorNode(Node):\r\n    def __init__(self):\r\n        super().__init__('robust_sensor_node')\r\n        \r\n        # Create publishers with different QoS for different data\r\n        reliable_qos = QoSProfile(depth=10, reliability=1)  # RELIABLE\r\n        best_effort_qos = QoSProfile(depth=5, reliability=0)  # BEST_EFFORT\r\n        \r\n        self.laser_pub = self.create_publisher(\r\n            LaserScan, 'laser_scan', reliable_qos)\r\n        \r\n        # Timer with error handling\r\n        self.timer = self.create_timer(0.1, self.publish_sensors)\r\n        self.error_count = 0\r\n        self.get_logger().info('Robust sensor node started')\r\n\r\n    def publish_sensors(self):\r\n        try:\r\n            # Simulate occasional sensor errors\r\n            if random.random() < 0.05:  # 5% error rate\r\n                self.get_logger().warn('Simulated sensor error')\r\n                raise Exception(\"Sensor reading error\")\r\n            \r\n            # Create and publish laser scan message\r\n            laser_msg = LaserScan()\r\n            laser_msg.header.stamp = self.get_clock().now().to_msg()\r\n            laser_msg.header.frame_id = 'laser_frame'\r\n            laser_msg.angle_min = -1.57\r\n            laser_msg.angle_max = 1.57\r\n            laser_msg.angle_increment = 0.1\r\n            laser_msg.range_min = 0.1\r\n            laser_msg.range_max = 10.0\r\n            laser_msg.ranges = [random.uniform(1.0, 5.0) for _ in range(32)]\r\n            \r\n            self.laser_pub.publish(laser_msg)\r\n            if self.error_count > 0:\r\n                self.error_count = 0  # Reset error counter on success\r\n                self.get_logger().info('Sensor recovered from error')\r\n                \r\n        except Exception as e:\r\n            self.error_count += 1\r\n            self.get_logger().error(f'Sensor error #{self.error_count}: {e}')\r\n            \r\n            # Implement recovery strategy after N consecutive errors\r\n            if self.error_count >= 5:\r\n                self.get_logger().error('Too many consecutive errors, initiating recovery...')\r\n                self.attempt_recovery()\r\n\r\n    def attempt_recovery(self):\r\n        # Simulate recovery attempt\r\n        self.get_logger().info('Attempting sensor recovery...')\r\n        # In a real system, this might reinitialize hardware, etc.\r\n        self.error_count = 0\r\n        self.get_logger().info('Recovery attempt completed')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    sensor_node = RobustSensorNode()\r\n    \r\n    try:\r\n        rclpy.spin(sensor_node)\r\n    except KeyboardInterrupt:\r\n        sensor_node.get_logger().info('Interrupted by user')\r\n    finally:\r\n        sensor_node.destroy_node()\r\n        rclpy.shutdown()\n"})}),"\n",(0,t.jsx)(r.h2,{id:"exercise-5-system-integration-testing",children:"Exercise 5: System Integration Testing"}),"\n",(0,t.jsx)(r.h3,{id:"objective-4",children:"Objective"}),"\n",(0,t.jsx)(r.p,{children:"Test the complete system and validate communication between nodes."}),"\n",(0,t.jsx)(r.h3,{id:"steps-4",children:"Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create a test script"})," (",(0,t.jsx)(r.code,{children:"robot_system/test_system.py"}),"):"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import LaserScan\r\nfrom std_msgs.msg import Float32\r\nimport time\r\n\r\nclass SystemTester(Node):\r\n    def __init__(self):\r\n        super().__init__('system_tester')\r\n        \r\n        # Subscribe to all relevant topics\r\n        self.cmd_sub = self.create_subscription(\r\n            Twist, 'cmd_vel', self.cmd_callback, 10)\r\n        self.laser_sub = self.create_subscription(\r\n            LaserScan, 'laser_scan', self.laser_callback, 10)\r\n        self.odom_sub = self.create_subscription(\r\n            Float32, 'odometry', self.odom_callback, 10)\r\n        \r\n        # Track message counts\r\n        self.cmd_count = 0\r\n        self.laser_count = 0\r\n        self.odom_count = 0\r\n        \r\n        # Test timer\r\n        self.test_timer = self.create_timer(5.0, self.run_test)\r\n        self.test_step = 0\r\n        \r\n        self.get_logger().info('System tester started')\r\n\r\n    def cmd_callback(self, msg):\r\n        self.cmd_count += 1\r\n\r\n    def laser_callback(self, msg):\r\n        self.laser_count += 1\r\n\r\n    def odom_callback(self, msg):\r\n        self.odom_count += 1\r\n\r\n    def run_test(self):\r\n        self.test_step += 1\r\n        \r\n        if self.test_step == 1:\r\n            self.get_logger().info('Starting system test...')\r\n            self.get_logger().info('Initial counts - Cmd: {}, Laser: {}, Odom: {}'.format(\r\n                self.cmd_count, self.laser_count, self.odom_count))\r\n        elif self.test_step == 2:\r\n            current_counts = f'Cmd: {self.cmd_count}, Laser: {self.laser_count}, Odom: {self.odom_count}'\r\n            self.get_logger().info(f'Counts after 5s: {current_counts}')\r\n            \r\n            # Verify that messages are flowing\r\n            if all(count > 0 for count in [self.cmd_count, self.laser_count, self.odom_count]):\r\n                self.get_logger().info('\u2713 All topics are active')\r\n            else:\r\n                self.get_logger().error('\u2717 Some topics are inactive')\r\n        elif self.test_step == 3:\r\n            final_counts = f'Cmd: {self.cmd_count}, Laser: {self.laser_count}, Odom: {self.odom_count}'\r\n            self.get_logger().info(f'Final counts: {final_counts}')\r\n            self.get_logger().info('System test completed')\r\n            self.test_timer.cancel()\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    tester = SystemTester()\r\n    rclpy.spin(tester)\r\n    tester.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"2",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Add test entry point to setup.py"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:"entry_points={\r\n    'console_scripts': [\r\n        'sensor_node = robot_system.sensor_node:main',\r\n        'controller_node = robot_system.controller_node:main',\r\n        'monitor_node = robot_system.monitor_node:main',\r\n        'system_tester = robot_system.test_system:main',  # Add this line\r\n    ],\r\n},\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"3",children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Run the complete test"}),":"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# Terminal 1: Start the robot system\r\ncd ~/ros2_ws\r\ncolcon build --packages-select robot_system\r\nsource install/setup.bash\r\nros2 run robot_system sensor_node & ros2 run robot_system controller_node & ros2 run robot_system monitor_node\r\n\r\n# Terminal 2: Run the system tester\r\nsource install/setup.bash\r\nros2 run robot_system system_tester\n"})}),"\n",(0,t.jsx)(r.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(r.p,{children:"These practical exercises helped you build a complete multi-node robot system using ROS 2 concepts including:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Node creation and management"}),"\n",(0,t.jsx)(r.li,{children:"Topic communication patterns"}),"\n",(0,t.jsx)(r.li,{children:"Custom message types"}),"\n",(0,t.jsx)(r.li,{children:"QoS configuration"}),"\n",(0,t.jsx)(r.li,{children:"Error handling and recovery"}),"\n",(0,t.jsx)(r.li,{children:"System testing and validation"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"additional-challenges",children:"Additional Challenges"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Enhance the system"}),": Add more sensor types (IMU, camera) with appropriate QoS settings"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Implement navigation"}),": Create a path-following controller"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Add simulation"}),": Use Gazebo to test with a simulated robot"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Create a dashboard"}),": Develop a simple GUI to monitor system status"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Implement logging"}),": Add comprehensive logging for debugging"]}),"\n"]}),"\n",(0,t.jsx)(r.p,{children:"This completes the submodules for Week 2 of Module 1 on Nodes and Topics in ROS 2."})]})}function m(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var s=n(6540);const t={},o=s.createContext(t);function i(e){const r=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:r},e.children)}}}]);