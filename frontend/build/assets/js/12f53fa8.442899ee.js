"use strict";(globalThis.webpackChunkphysical_ai_platform_frontend=globalThis.webpackChunkphysical_ai_platform_frontend||[]).push([[233],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}},9237:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"module-1/week-2-nodes-topics/2-2-working-with-topics","title":"2.2: Working with ROS 2 Topics","description":"Overview","source":"@site/docs/module-1/week-2-nodes-topics/2-2-working-with-topics.md","sourceDirName":"module-1/week-2-nodes-topics","slug":"/module-1/week-2-nodes-topics/2-2-working-with-topics","permalink":"/docs/module-1/week-2-nodes-topics/2-2-working-with-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/noor-ana/physical-ai-platform/tree/main/docs/module-1/week-2-nodes-topics/2-2-working-with-topics.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"difficulty":"intermediate"},"sidebar":"tutorialSidebar","previous":{"title":"2.1: Understanding ROS 2 Nodes","permalink":"/docs/module-1/week-2-nodes-topics/2-1-understanding-nodes"},"next":{"title":"2.3: Topic Design Patterns and Best Practices","permalink":"/docs/module-1/week-2-nodes-topics/2-3-topic-design-patterns"}}');var r=s(4848),o=s(8453);const t={sidebar_position:2,difficulty:"intermediate"},l="2.2: Working with ROS 2 Topics",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Topic Communication Pattern",id:"topic-communication-pattern",level:2},{value:"Basic Topic Flow",id:"basic-topic-flow",level:3},{value:"Creating Publishers",id:"creating-publishers",level:2},{value:"Python Publisher",id:"python-publisher",level:3},{value:"C++ Publisher",id:"c-publisher",level:3},{value:"Creating Subscribers",id:"creating-subscribers",level:2},{value:"Python Subscriber",id:"python-subscriber",level:3},{value:"C++ Subscriber",id:"c-subscriber",level:3},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:2},{value:"Common QoS Settings",id:"common-qos-settings",level:3},{value:"Custom Message Types",id:"custom-message-types",level:2},{value:"Creating Custom Messages",id:"creating-custom-messages",level:3},{value:"Using Custom Messages",id:"using-custom-messages",level:3},{value:"Topic Tools and Monitoring",id:"topic-tools-and-monitoring",level:2},{value:"Command-Line Tools",id:"command-line-tools",level:3},{value:"Advanced Topic Inspection",id:"advanced-topic-inspection",level:3},{value:"Topic Debugging",id:"topic-debugging",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"Debugging Code Example",id:"debugging-code-example",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"22-working-with-ros-2-topics",children:"2.2: Working with ROS 2 Topics"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"This submodule explores ROS 2 topics in detail, which are the primary mechanism for asynchronous communication between nodes using a publish-subscribe pattern."}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"By the end of this submodule, you will:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Understand the publish-subscribe communication pattern"}),"\n",(0,r.jsx)(n.li,{children:"Create publishers and subscribers in Python and C++"}),"\n",(0,r.jsx)(n.li,{children:"Work with different message types and custom messages"}),"\n",(0,r.jsx)(n.li,{children:"Configure Quality of Service (QoS) policies for topics"}),"\n",(0,r.jsx)(n.li,{children:"Debug and monitor topics using ROS 2 tools"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"topic-communication-pattern",children:"Topic Communication Pattern"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 uses a ",(0,r.jsx)(n.strong,{children:"publish-subscribe"})," model for asynchronous communication. In this pattern:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publishers"})," send messages to topics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscribers"})," receive messages from topics"]}),"\n",(0,r.jsx)(n.li,{children:"Multiple publishers and subscribers can use the same topic"}),"\n",(0,r.jsx)(n.li,{children:"Communication is decoupled in time and space"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"basic-topic-flow",children:"Basic Topic Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Publisher Node \u2192 Topic \u2192 Subscriber Node\n     \u2193                    \u2191\nPublisher Node \u2192--------\u2192 Subscriber Node\n"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-publishers",children:"Creating Publishers"}),"\n",(0,r.jsx)(n.h3,{id:"python-publisher",children:"Python Publisher"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"c-publisher",children:"C++ Publisher"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include <rclcpp/rclcpp.hpp>\n#include <std_msgs/msg/string.hpp>\n\nusing namespace std::chrono_literals;\n\nclass MinimalPublisher : public rclcpp::Node\n{\npublic:\n    MinimalPublisher() : Node("minimal_publisher")\n    {\n        publisher_ = this->create_publisher<std_msgs::msg::String>("topic", 10);\n        timer_ = this->create_wall_timer(\n            500ms, std::bind(&MinimalPublisher::timer_callback, this));\n        count_ = 0;\n    }\n\nprivate:\n    void timer_callback()\n    {\n        auto message = std_msgs::msg::String();\n        message.data = "Hello World: " + std::to_string(count_++);\n        RCLCPP_INFO(this->get_logger(), "Publishing: \'%s\'", message.data.c_str());\n        publisher_->publish(message);\n    }\n    rclcpp::TimerBase::SharedPtr timer_;\n    rclcpp::Publisher<std_msgs::msg::String>::SharedPtr publisher_;\n    size_t count_;\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"creating-subscribers",children:"Creating Subscribers"}),"\n",(0,r.jsx)(n.h3,{id:"python-subscriber",children:"Python Subscriber"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"c-subscriber",children:"C++ Subscriber"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include <rclcpp/rclcpp.hpp>\n#include <std_msgs/msg/string.hpp>\n\nclass MinimalSubscriber : public rclpp::Node\n{\npublic:\n    MinimalSubscriber() : Node("minimal_subscriber")\n    {\n        subscription_ = this->create_subscription<std_msgs::msg::String>(\n            "topic", 10,\n            std::bind(&MinimalSubscriber::topic_callback, this, std::placeholders::_1));\n    }\n\nprivate:\n    void topic_callback(const std_msgs::msg::String::SharedPtr msg) const\n    {\n        RCLCPP_INFO(this->get_logger(), "I heard: \'%s\'", msg->data.c_str());\n    }\n    rclcpp::Subscription<std_msgs::msg::String>::SharedPtr subscription_;\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,r.jsx)(n.p,{children:"QoS policies control how messages are delivered between publishers and subscribers:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy, DurabilityPolicy\n\n# Create a custom QoS profile\nqos_profile = QoSProfile(\n    depth=10,  # Number of messages to buffer\n    reliability=ReliabilityPolicy.RELIABLE,  # or BEST_EFFORT\n    history=HistoryPolicy.KEEP_LAST,  # or KEEP_ALL\n    durability=DurabilityPolicy.VOLATILE  # or TRANSIENT_LOCAL\n)\n\n# Use the custom QoS profile\npublisher = node.create_publisher(String, 'topic', qos_profile)\nsubscription = node.create_subscription(String, 'topic', callback, qos_profile)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"common-qos-settings",children:"Common QoS Settings"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reliability"}),": ",(0,r.jsx)(n.code,{children:"RELIABLE"})," ensures all messages are delivered; ",(0,r.jsx)(n.code,{children:"BEST_EFFORT"})," doesn't guarantee delivery"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"History"}),": ",(0,r.jsx)(n.code,{children:"KEEP_LAST"})," keeps the most recent N messages; ",(0,r.jsx)(n.code,{children:"KEEP_ALL"})," keeps all messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Depth"}),": Number of messages to store in the history"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Durability"}),": ",(0,r.jsx)(n.code,{children:"VOLATILE"})," for temporary messages; ",(0,r.jsx)(n.code,{children:"TRANSIENT_LOCAL"})," for persistent messages"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"custom-message-types",children:"Custom Message Types"}),"\n",(0,r.jsx)(n.h3,{id:"creating-custom-messages",children:"Creating Custom Messages"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a msg directory in your package"}),"\n",(0,r.jsxs)(n.li,{children:["Define your message in a ",(0,r.jsx)(n.code,{children:".msg"})," file:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# MyCustomMessage.msg\nstring name\nint32 id\nfloat64 value\nbool active\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Update your package.xml to export the message:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<build_depend>rosidl_default_generators</build_depend>\n<exec_depend>rosidl_default_runtime</exec_depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Update CMakeLists.txt:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/MyCustomMessage.msg"\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-custom-messages",children:"Using Custom Messages"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from my_package_msgs.msg import MyCustomMessage\n\n# Publisher with custom message\npublisher = node.create_publisher(MyCustomMessage, 'custom_topic', 10)\n\nmsg = MyCustomMessage()\nmsg.name = 'Robot1'\nmsg.id = 1\nmsg.value = 3.14\nmsg.active = True\n\npublisher.publish(msg)\n\n# Subscriber with custom message\nsubscription = node.create_subscription(\n    MyCustomMessage,\n    'custom_topic',\n    callback,\n    10\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"topic-tools-and-monitoring",children:"Topic Tools and Monitoring"}),"\n",(0,r.jsx)(n.h3,{id:"command-line-tools",children:"Command-Line Tools"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List all topics\nros2 topic list\n\n# Get information about a topic\nros2 topic info /topic_name\n\n# Echo messages from a topic\nros2 topic echo /topic_name\n\n# Publish to a topic from command line\nros2 topic pub /topic_name std_msgs/msg/String \"data: 'Hello'\"\n\n# Print the type of a topic\nros2 topic type /topic_name\n\n# Show bandwidth usage of topics\nros2 topic bw\n\n# Show Hz rate of a topic\nros2 topic hz /topic_name\n\n# Show latency of a topic\nros2 topic delay /topic_name\n"})}),"\n",(0,r.jsx)(n.h3,{id:"advanced-topic-inspection",children:"Advanced Topic Inspection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Echo with field filtering\nros2 topic echo /topic_name --field data\n\n# Echo with limiting messages\nros2 topic echo /topic_name --field data --count 5\n\n# Echo with specific format\nros2 topic echo /topic_name --field data --field_filter "data"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"topic-debugging",children:"Topic Debugging"}),"\n",(0,r.jsx)(n.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"No messages being received"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check if publisher and subscriber are on the same topic"}),"\n",(0,r.jsx)(n.li,{children:"Verify QoS compatibility between publisher and subscriber"}),"\n",(0,r.jsx)(n.li,{children:"Ensure nodes are running and connected"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Old messages not being received"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check QoS history policy"}),"\n",(0,r.jsx)(n.li,{children:"Verify depth setting is adequate"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Message drops"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check network connectivity"}),"\n",(0,r.jsx)(n.li,{children:"Verify QoS reliability settings"}),"\n",(0,r.jsx)(n.li,{children:"Monitor system resources"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"debugging-code-example",children:"Debugging Code Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def debug_topic_info(node):\n    # Get list of topics and their types\n    topic_names_and_types = node.get_topic_names_and_types()\n    \n    for name, types in topic_names_and_types:\n        print(f"Topic: {name}, Types: {types}")\n        \n        # Get specific info about the topic\n        try:\n            info = node.get_publishers_info_by_topic(name)\n            print(f"  Publishers: {len(info)}")\n            for pub in info:\n                print(f"    - {pub.node_name}, QoS: {pub.qos_profile}")\n                \n            info = node.get_subscriptions_info_by_topic(name)\n            print(f"  Subscribers: {len(info)}")\n        except Exception as e:\n            print(f"  Error getting info: {e}")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic Naming"}),": Use descriptive, consistent names (e.g., ",(0,r.jsx)(n.code,{children:"/robot_1/sensor_data"})," instead of ",(0,r.jsx)(n.code,{children:"data"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"QoS Settings"}),": Choose appropriate QoS settings based on your application requirements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Message Design"}),": Design message types to minimize bandwidth while providing necessary information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Buffer Sizes"}),": Set appropriate buffer sizes based on message frequency and processing requirements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": Implement proper error handling for communication issues"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"This submodule covered working with ROS 2 topics including publishers, subscribers, QoS policies, custom messages, and debugging techniques. In the next submodule, we'll explore more advanced communication patterns in ROS 2."})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);